:root{
  --bg:#f7f8fa; --panel:#ffffff; --ink:#1f2937; --muted:#6b7280;
  --accent:#2563eb; --accent-ink:#fff;
  --line:#e5e7eb; --shadow:0 10px 24px rgba(0,0,0,.08);
}
*{box-sizing:border-box}
html,body{height:100%;}
body{margin:0;color:var(--ink);background:var(--bg);font:14px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Sans","Noto Sans JP","Yu Gothic",sans-serif;}

.app-header{height:48px;background:var(--panel);display:flex;align-items:center;justify-content:space-between;padding:0 16px;border-bottom:1px solid var(--line);position:sticky;top:0;z-index:10}
.brand{font-weight:700}
.metric-select label{margin-right:8px;color:var(--muted)}

main{position:relative;height:calc(100vh - 48px);}
#map{position:absolute;inset:0}

.drawer{position:absolute;left:0;top:48px;bottom:0;width:320px;background:var(--panel);border-right:1px solid var(--line);box-shadow:var(--shadow);z-index:11;transition:transform .25s ease}
.drawer.open{transform:translateX(0)}
.drawer:not(.open){transform:translateX(-100%)}
.drawer-toggle{position:absolute;right:-16px;top:8px;width:24px;height:24px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer;box-shadow:var(--shadow)}
.tabs{display:flex;gap:8px;padding:12px;border-bottom:1px solid var(--line)}
.tab{border:none;background:#f3f4f6;padding:6px 10px;border-radius:8px;cursor:pointer}
.tab.active{background:var(--accent);color:var(--accent-ink)}
.tab-content{padding:12px 16px;overflow:auto;height:calc(100% - 70px)}
.tab-content.hidden{display:none}
.field{margin:10px 0}
.field label{display:block;margin-bottom:6px;color:var(--muted)}
.primary{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
.secondary{background:#e5e7eb;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
.hint{color:var(--muted);font-size:12px}
.list{padding-left:18px}

.tools{position:absolute;right:14px;top:70px;display:flex;flex-direction:column;gap:10px;z-index:9}
.tool-btn{background:#fff;border:1px solid var(--line);border-radius:10px;padding:10px 12px;cursor:pointer;box-shadow:var(--shadow);min-width:72px}
.tool-btn.active{border-color:var(--accent);color:var(--accent)}

.timebar{position:absolute;left:50%;transform:translateX(-50%);bottom:18px;background:#fff;border:1px solid var(--line);border-radius:12px;padding:8px 12px;display:flex;align-items:center;gap:12px;box-shadow:var(--shadow);z-index:9}
.icon-btn{border:none;background:#f3f4f6;border-radius:8px;padding:6px 10px;cursor:pointer}
.time-label{min-width:80px;text-align:center;font-weight:600}

.legend{position:absolute;right:14px;bottom:18px;background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px 12px;box-shadow:var(--shadow);z-index:9;min-width:160px}
.legend-title{font-weight:700;margin-bottom:6px}
.legend-scale{display:grid;grid-template-columns:auto 1fr;gap:6px;align-items:center;margin-bottom:6px}
.swatch{display:inline-block;width:18px;height:12px;border-radius:3px;margin-right:6px}
.swatch-l{background:#cde7f8}
.swatch-m{background:#f9e29b}
.swatch-h{background:#f59ea0}
.credit{color:var(--muted);font-size:12px}
